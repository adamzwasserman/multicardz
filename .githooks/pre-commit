#!/bin/bash
# MultiCardz‚Ñ¢ Pre-commit Hook
# Runs smart test selection for maximum speed while ensuring quality

set -e

echo "üîç MultiCardz‚Ñ¢ Pre-commit Hook - Running Smart Tests"
echo "=================================================="

# Check if test_runner.py exists
if [ ! -f "test_runner.py" ]; then
    echo "‚ùå test_runner.py not found"
    exit 1
fi

# Run smart tests with all optimizations
echo "üß† Running smart test selection..."
uv run python test_runner.py all --smart --time --parallel --no-cache

# Check exit code
if [ $? -eq 0 ]; then
    echo ""
    echo "‚úÖ All smart tests passed! Commit proceeding..."
    echo "=================================================="
    exit 0
else
    echo ""
    echo "‚ùå Tests failed! Commit blocked."
    echo "   Fix failing tests before committing."
    echo "   Run 'uv run python test_runner.py all --smart' to debug."
    echo "=================================================="
    exit 1
fi