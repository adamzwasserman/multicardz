/* MultiCardz Spatial Interface CSS - 4×3 Grid System */

/* Base body styling */
body {
    margin: 0;
    padding: 0;
    background: var(--color-muji-bg);
    color: var(--color-text-primary);
}


/* ========================================
   COLOR SYSTEM ARCHITECTURE
   ========================================

   Brand vs Functional Separation Philosophy:
   Following sophisticated systems like Stripe (purple brand/blue actions),
   Notion (black brand/blue UI), Figma (rainbow brand/blue primary actions).

   BRAND COLORS (Non-interactive, Identity):
   - Brand Red (#dc2626): Wordmark dot, logo, brand moments, celebrations
   - Used for: Loading states, empty states, brand accent elements

   FUNCTIONAL COLORS (Interactive, UI):
   - Action Blue (#1e40af): Primary CTAs, selected states, interactive elements
   - Success Green (#059669): Valid drop targets, positive feedback
   - Warning Amber (#d97706): Caution states, attention needed
   - Error Red (#b91c1c): Destructive actions only (darker than brand red)

   DRAG-DROP STATE MACHINE:
   1. Tag → Zone: Success Green for valid zones
   2. Zone → Zone: NO visual feedback (blocked operation)
   3. Zone → Control Area: Action Blue borders on control areas
   ======================================== */

/* CSS Custom Properties - Color System with light-dark() */
:root {
  color-scheme: light dark;

  /* Brand Colors */
  --color-brand-primary: #dc2626;  /* Brand Red - consistent in both modes */
  --color-brand-hover: light-dark(#ef4444, #f87171);
  --color-brand-accent: light-dark(#fef2f2, #2d2d2d);

  /* Functional Colors */
  --color-action-primary: #0d6efd;  /* Bootstrap Blue - consistent */
  --color-action-hover: light-dark(#0b5ed7, #3b82f6);
  --color-action-light: light-dark(#cfe2ff, #1a1a1a);
  --color-action-accent: #6ea8fe;   /* Medium blue for accents */

  /* Feedback Colors */
  --color-success: light-dark(#059669, #10b981);
  --color-success-light: light-dark(#d1fae5, #0f0f0f);
  --color-warning: light-dark(#d97706, #f59e0b);
  --color-warning-light: light-dark(#fef3c7, #1a1a1a);
  --color-error: light-dark(#b91c1c, #ef4444);
  --color-error-light: light-dark(#fee2e2, #1a1a1a);

  /* Neutral Colors - Claude-inspired dark mode */
  --color-neutral-50: light-dark(#fafafa, #0a0a0a);
  --color-neutral-100: light-dark(#f5f5f5, #141414);
  --color-neutral-200: light-dark(#e5e5e5, #1f1f1f);
  --color-neutral-300: light-dark(#d4d4d4, #2d2d2d);
  --color-neutral-400: light-dark(#a3a3a3, #4a4a4a);
  --color-neutral-500: #737373;  /* Middle gray - same in both */
  --color-neutral-600: light-dark(#525252, #8a8a8a);
  --color-neutral-700: light-dark(#404040, #b8b8b8);
  --color-neutral-800: light-dark(#262626, #d4d4d4);
  --color-neutral-900: light-dark(#171717, #f0f0f0);

  /* Muji Minimalist Palette - High contrast dark mode */
  --color-muji-bg: light-dark(#fefefe, #0f0f0f);
  --color-muji-border: light-dark(#f0f0f0, #1f1f1f);
  --color-muji-text: light-dark(#333, #e5e5e5);
  --color-muji-text-secondary: light-dark(#666, #9a9a9a);
  --color-muji-hover: light-dark(#f8f8f8, #1a1a1a);

  /* Text colors - Better contrast */
  --color-text-primary: light-dark(#333, #e5e5e5);
  --color-text-secondary: light-dark(#666, #9a9a9a);
  --color-text-tertiary: light-dark(#999, #6a6a6a);
}

/* ========================================
   EARTH TONES THEME - CONSOLIDATED STYLES
   ======================================== */

/* Earth Tones Color Variables */
.earth-tones {
  --color-brand-primary: #dc2626;  /* Keep red accent */
  --color-brand-hover: #ef4444;
  --color-brand-accent: #fef2f2;

  --color-action-primary: #0d6efd;  /* Keep Bootstrap blue */
  --color-action-hover: #0b5ed7;
  --color-action-light: #e8e4dc;

  --color-muji-bg: #f5f2ed;  /* Warm beige background like image */
  --color-muji-border: #e0dcd4;  /* Soft warm border */
  --color-muji-text: #4a453f;  /* Dark warm brown text */
  --color-muji-text-secondary: #6b645c;  /* Medium warm brown */
  --color-muji-hover: #ebe7e0;  /* Light warm hover state */
}

/* Earth Tones Body and Base Interface */
.earth-tones {
  /* Base background */
  background: #faf9f7 !important;
  color: #57534e !important;
}

.earth-tones body,
.earth-tones .wasm-container,
.earth-tones .spatial-grid {
  background: #f5f2ed !important;  /* Warm beige like image */
  color: #4a453f !important;
}

/* Earth Tones Typography */
.earth-tones h1,
.earth-tones h2,
.earth-tones h3,
.earth-tones h4,
.earth-tones h5,
.earth-tones h6 {
  color: #4a453f !important;  /* Dark warm brown */
}

.earth-tones .description,
.earth-tones .legend,
.earth-tones .footer-info {
  color: #78716c;
}

.earth-tones p,
.earth-tones span,
.earth-tones div,
.earth-tones label {
  color: #6b645c !important;  /* Medium warm brown */
}

/* Earth Tones Navigation */
.earth-tones .main-navigation {
  background: #f5f2ed;
  border-bottom-color: #e0dcd4;
}

.earth-tones .brand-link {
  color: #4a453f;
}

.earth-tones .brand-link:hover,
.earth-tones .nav-item a:hover {
  color: #dc2626;  /* Red accent on hover */
}

.earth-tones .brand-link .brand-i {
  color: #4a453f;
}

.earth-tones .nav-item a {
  color: #6b645c;
}

.earth-tones .cta-button {
  background: #f5f5f4 !important;
  color: #57534e !important;
  border-color: var(--color-action-primary);
}

.earth-tones .cta-button:hover {
  background: var(--color-action-primary) !important;
  color: white !important;
}

/* Earth Tones Grid Areas */
.earth-tones .tag-management {
  background: transparent;
  border-color: transparent;
}

.earth-tones .universal-control,
.earth-tones .top-control,
.earth-tones .ui-control,
.earth-tones .left-control,
.earth-tones .right-control,
.earth-tones .card-display,
.earth-tones .bottom-control {
  background: #faf8f5;  /* Slightly lighter cards */
  border-color: #e0dcd4;
  color: #4a453f;
}

.earth-tones .universal-control h3,
.earth-tones .ui-control h3 {
  color: #4a453f;
}

.earth-tones .universal-control p,
.earth-tones .card-display p,
.earth-tones .bottom-control p {
  color: #6b645c;
}

/* Earth Tones Drop Zones */
.earth-tones .drop-zone {
  background: #f7f6f3;
  border-color: #d6d3d1;
  color: #78716c;
}

.earth-tones .tag-dragging .drop-zone:hover {
  border-color: var(--color-action-primary);
  background: var(--color-action-light);
}

.earth-tones .drop-zone.drag-over {
  border-color: #dc2626;
  background: #fef2f2;
  color: #57534e;
}

.earth-tones .control-area-container.drag-over {
  background: var(--color-action-light);
  border-color: var(--color-action-primary);
}

.earth-tones .control-area-container.drag-over::after {
  color: var(--color-action-primary);
}

/* Earth Tones Zone Headers and Labels */
.earth-tones .zone-header {
  color: #57534e;
}

.earth-tones .zone-label {
  color: #78716c;
}

/* Earth Tones View Elements */
.earth-tones .view-description {
  background: rgba(250, 249, 247, 0.5);
}

.earth-tones .view-description p {
  color: #78716c;
}

.earth-tones .view-legend {
  background: rgba(245, 245, 244, 0.3);
}

.earth-tones .view-legend p {
  color: #78716c;
}

.earth-tones .font-medium {
  color: #57534e;
}

.earth-tones .advanced-hint {
  background: var(--color-warning-light);
  border-color: var(--color-warning);
  color: var(--color-neutral-800);
}

/* Earth Tones Card System */
.earth-tones .card {
  background: #faf8f5; /* Warm off-white like cards in image */
  border: 1px solid #a8a29e; /* Same outline as system tags */
}

.earth-tones .card:hover {
  background: #f0ede8; /* Slightly darker warm hover */
  border-color: #78716c; /* Darker border on hover */
}

.earth-tones .card-title {
  color: #4a453f; /* Dark warm brown */
}

.earth-tones .card-description {
  color: #6b645c; /* Medium warm brown */
}

.earth-tones .card-tags {
  border-top-color: #e0dcd4; /* Warm separator */
}

.earth-tones .card-tag {
  background: #ebe7e0; /* Warm tag background */
  color: #6b645c; /* Warm tag text */
}

/* Earth Tones Cloud System */
.earth-tones .cloud-user,
.earth-tones .cloud-mixed {
  background-color: #faf8f5;
  border-color: #e0dcd4;
}

.earth-tones .cloud-ai {
  background-color: #faf8f5;
  border-color: #d4cfc6;
}

.earth-tones .cloud-group {
  background-color: #faf8f5;
  border-color: #e0dcd4;
}

.earth-tones .cloud-system {
  background-color: #faf8f5;
  border-color: #6b645c;
}

.earth-tones .cloud.drag-over {
  border-color: var(--color-action-primary);
  background: var(--color-action-light);
  box-shadow: 0 4px 8px rgba(30, 64, 175, 0.15);
}

/* Earth Tones Cloud Titles */
.earth-tones .cloud-title-user,
.earth-tones .cloud-title-mixed {
  color: #4a453f;
}

.earth-tones .cloud-title-ai {
  color: #6b645c;
}

.earth-tones .cloud-title-group {
  color: #6b645c;
}

.earth-tones .cloud-title-system {
  color: #3a352f;
}

.earth-tones .tag-count {
  color: #9b9489;
}

/* Earth Tones Tag System */
.earth-tones .tag-user {
  background-color: #ffffff;
  border-color: #d6d3d1;
  color: #57534e;
}

.earth-tones .tag-ai {
  background-color: #f5f5f4;
  border-color: #d6d3d1;
  color: #6b7280;
}

.earth-tones .tag-group {
  border-color: #a8a29e;
  color: #78716c;
}

.earth-tones .tag-system {
  background-color: #e7e5e4;
  border-color: #a8a29e;
  color: #292524;
}

/* Earth Tones Form Elements */
.earth-tones input,
.earth-tones select,
.earth-tones button {
  background: #faf8f5 !important;  /* Slightly lighter than main bg */
  border-color: #e0dcd4 !important;
  color: #4a453f !important;
}

.earth-tones input:focus,
.earth-tones select:focus {
  border-color: #c4beb3 !important;  /* Warmer focus border */
}

.earth-tones button:hover {
  background: #ebe7e0 !important;
}

.earth-tones .tag-input {
  border-color: #d6d3d1;
  background-color: rgba(255, 255, 255, 0.9);
}

.earth-tones .tag-input:focus {
  border-color: #a8a29e;
}

.earth-tones .ai-button {
  background-color: #e7e5e4;
  border-color: #d6d3d1;
}

.earth-tones .ai-button:hover {
  background-color: #d6d3d1;
}

.earth-tones .font-selector {
  border-color: #d6d3d1;
}

.earth-tones .font-selector:focus {
  border-color: #a8a29e;
}

.earth-tones .checkbox-group {
  color: #78716c;
}

.earth-tones .tags-in-play {
  background: #faf8f5 !important;
  border-color: #e0dcd4 !important;
  color: #6b645c !important;
}

/* Earth Tones Drag Handles */
.earth-tones .zone-drag-handle:hover {
  background: rgba(87, 83, 78, 0.1);
}

.earth-tones .zone-drag-handle:active {
  background: rgba(87, 83, 78, 0.15);
}

.earth-tones .drag-grip {
  color: #a8a29e;
}

.earth-tones .zone-drag-handle:hover .drag-grip {
  color: #78716c;
}

/* Navigation Header - Muji Minimalist Style */
.main-navigation {
    background: var(--color-muji-bg);
    border-bottom: 1px solid var(--color-muji-border);
    position: sticky;
    top: 0;
    z-index: 1000;
    margin: 8px;
    border-radius: 4px;
    /* Remove shadow for clean Muji aesthetic */
    backdrop-filter: blur(10px);
}

.nav-container {
    margin: 0;
    padding: 0 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 60px;
    width: calc(100% - 4rem);
}

.brand {
    flex-shrink: 0;
}

.brand-link {
    font-family: 'Dongle', sans-serif !important;  /* Always use Dongle for logo */
    font-size: 56px;
    font-weight: 400;
    color: var(--color-text-primary);
    text-decoration: none;
    letter-spacing: 0;
}

.brand-link:hover {
    color: var(--color-brand-primary);  /* Brand Red on hover */
    transition: color 0.3s ease;
}

.brand-link .brand-i {
    color: var(--color-text-primary);
    position: relative;
}

.brand-link .brand-i::after {
    content: '';
    position: absolute;
    top: 21px;
    left: 51%;
    transform: translateX(-50%);
    width: 8px;
    height: 8px;
    background-color: var(--color-brand-primary);  /* Brand Red for wordmark dot */
    border-radius: 50%;
    z-index: 1;
}

.nav-menu {
    flex-shrink: 0;
}

.nav-items {
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
    gap: 2.5rem;
    align-items: center;
}

.nav-item {
    margin: 0;
}

.nav-item a {
    text-decoration: none;
    color: var(--color-text-secondary);
    font-weight: 400;
    font-size: 0.9rem;
    padding: 0.5rem 0;
    transition: color 0.3s ease;
    font-family: inherit;  /* Inherit the selected font from body */
}

.nav-item a:hover {
    color: var(--color-brand-primary);  /* Brand Red for nav hover */
}

.cta-button {
    background: var(--color-muji-hover) !important;
    color: var(--color-muji-text) !important;
    padding: 0.7rem 1.8rem !important;
    border: 1px solid var(--color-action-primary);  /* Bootstrap Blue for primary CTA */
    border-radius: 0;
    font-weight: 400 !important;
    font-size: 0.9rem !important;
    transition: all 0.3s ease;
    cursor: pointer;
    font-family: inherit;  /* Inherit the selected font from body */
}

.cta-button:hover {
    background: var(--color-action-primary) !important;  /* Bootstrap Blue for CTA hover */
    color: white !important;
    border: 1px solid var(--color-action-primary);
}

/* Responsive Navigation */
@media (max-width: 768px) {
    .nav-container {
        padding: 0 0.5rem;
        height: 56px;
    }

    .nav-items {
        gap: 1rem;
    }

    .nav-item a {
        font-size: 0.875rem;
    }


}

@media (max-width: 640px) {
    .nav-items {
        gap: 0.75rem;
    }

    .nav-item:not(:last-child) {
        display: none;
    }

    .cta-button {
        padding: 0.5rem 1rem !important;
        font-size: 0.875rem !important;
    }
}

/* WASM Container */
.wasm-container {
    height: calc(100vh - 76px);
    overflow-y: auto;
    margin: 0 8px;
    box-sizing: border-box;
}

/* Base Grid Container */
.spatial-grid {
    display: grid;
    grid-template-rows: auto auto 1fr auto;
    grid-template-columns: 0.67fr 2fr 0.67fr;
    grid-template-areas:
        ". tag-management ."
        "universal-control top-control ui-control"
        "left-control card-display right-control"
        ". bottom-control .";
    gap: 1rem;
    width: 100%;
    height: calc(100vh - 76px - 2rem);
    padding: 1rem;
    box-sizing: border-box;
}

/* Grid Area Assignments */
.tag-management { grid-area: tag-management; }
.universal-control { grid-area: universal-control; }
.top-control { grid-area: top-control; }
.ui-control { grid-area: ui-control; }
.left-control { grid-area: left-control; }
.card-display { grid-area: card-display; }
.right-control { grid-area: right-control; }
.bottom-control { grid-area: bottom-control; }

/* Row 1: Tag Management Area (Middle Column Only) */
.tag-management {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 1rem;
    background: transparent;
    border-radius: 8px;
    border: 1px solid transparentplea;
}

/* Tag Clouds Container Layout */
.clouds-container {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    width: 100%;
}

/* User Tag Cloud - Full Width */
.cloud-user {
    width: 100%;
    order: 1;
}

/* Other Tag Clouds Container - Below User Tags */
.clouds-secondary {
    display: flex;
    flex-direction: row;
    gap: 1rem;
    order: 2;
}

.cloud-ai,
.cloud-group,
.cloud-system {
    flex: 1;
    min-width: 0; /* Allow flex items to shrink below content size */
}

.tag-cloud {
    background: white;
    border-radius: 6px;
    padding: 1rem;
    border: 1px solid #dee2e6;
}

.tag-cloud h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1.4rem;
    font-weight: 600;
    color: #495057;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.tag-groups {
    background: #f3e8ff;
    border: 1px solid #c4b5fd;
    border-radius: 6px;
    padding: 1rem;
    min-height: 80px;
}

.tag-groups h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1.4rem;
    font-weight: 600;
    color: #7c3aed;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Tag Styling */
.tag-item {
    display: inline-flex;
    align-items: center;
    background-color: light-dark(var(--color-neutral-500), var(--color-neutral-300));  /* Better contrast in dark mode */
    color: light-dark(white, var(--color-neutral-900));
    padding: 0.4rem 0.8rem;
    margin: 0.2rem;
    border-radius: 4px;
    font-size: 0.875rem;
    font-weight: 500;
    cursor: grab;
    user-select: none;
    transition: all 0.2s ease;
    border: 2px solid transparent;
}

.tag-item:hover {
    background-color: light-dark(var(--color-neutral-600), var(--color-neutral-400));
    transform: translateY(-1px);
    box-shadow: 0 2px 4px light-dark(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.3));
}

.tag-item:active {
    cursor: grabbing;
    transform: translateY(0);
}

.tag-item.selected {
    background-color: var(--color-action-primary);  /* Action Blue for selected state */
    border-color: var(--color-action-accent);
    box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.2);
}

.tag-item[draggable="true"] {
    cursor: grab;
}

/* Group Tag Styling */
.group-tag {
    background-color: #8b5cf6;
    border: 1px solid #7c3aed;
}

.group-tag:hover {
    background-color: #7c3aed;
}

/* Row 2: Control Areas (All 3 Columns) */
.universal-control, .top-control, .ui-control, .left-control, .right-control {
    background: light-dark(var(--color-muji-bg), var(--color-neutral-100));
    border: 1px solid var(--color-muji-border);
    border-radius: 4px;
    padding: 1rem;
    min-height: 120px;
}

.universal-control h3 {
    color: var(--color-text-primary);
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
    font-weight: 400;
}

.universal-control p {
    color: var(--color-text-secondary);
    font-size: 0.8rem;
    margin: 0;
    font-weight: 300;
}

.ui-control h3 {
    color: var(--color-text-primary);
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
    font-weight: 400;
}

/* View Description and Legend */
.view-description {
    margin-bottom: 1rem;
    padding: 0.5rem;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 4px;
}

.view-description p {
    margin: 0;
    font-size: 0.9rem;
    color: #555;
}

.advanced-hint {
    margin-top: 0.5rem;
    padding: 0.5rem;
    background: var(--color-warning-light);  /* Warning Amber for hints */
    border: 1px solid var(--color-warning);
    border-radius: 4px;
    font-size: 0.85rem;
    color: var(--color-neutral-800);
}

.advanced-hint.hidden {
    display: none;
}

.view-legend {
    margin-bottom: 1rem;
    padding: 0.5rem;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 4px;
    font-size: 0.8rem;
}

.view-legend p {
    margin: 0.2rem 0;
    color: #666;
}

.font-medium {
    font-weight: 500;
    color: #333;
}

/* Row 3: Main Content (All 3 Columns) */
.left-control, .right-control {
    min-height: 200px;
    overflow: hidden;
    box-sizing: border-box;
}

/* Zone labels consistent styling */
.zone-label {
    color: #666;
    font-size: 0.8rem;
    font-weight: 300;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 100%;
    text-align: center;
}

.card-display {
    background: light-dark(#fefefe, var(--color-neutral-100));
    border: 1px solid var(--color-muji-border);
    border-radius: 4px;
    padding: 2rem;
    text-align: center;
    color: var(--color-text-secondary);
    min-height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
}

.card-display p {
    font-size: 0.9rem;
    margin: 0;
    font-weight: 300;
}

/* Row 4: Bottom Control Area (Middle Column Only) */
.bottom-control {
    background: light-dark(#fefefe, var(--color-neutral-100));
    border: 1px solid var(--color-muji-border);
    border-radius: 4px;
    padding: 1rem;
    min-height: 80px;
    text-align: center;
    color: var(--color-text-secondary);
    overflow: hidden;
    box-sizing: border-box;
}

.bottom-control p {
    margin: 0;
    font-size: 0.8rem;
    font-weight: 300;
}

/* Drop Zones */
.drop-zone {
    background: light-dark(#fafafa, var(--color-neutral-200));
    border: 1px dashed light-dark(#e0e0e0, var(--color-neutral-300));
    border-radius: 4px;
    padding: 1rem;
    margin: 0.5rem 0;
    min-height: 60px;
    height: calc(100% - 100px);
    text-align: center;
    color: var(--color-text-secondary);
    font-size: 0.8rem;
    font-weight: 300;
    position: relative;
    transition: all 0.2s ease;
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.drop-zone .drag-handle::before {
    content: "⋮⋮";
    position: absolute;
    left: 8px;
    top: 50%;
    transform: translateY(-50%);
    width: 12px;
    height: 16px;
    color: #aaa;
    cursor: grab;
    font-size: 14px;
    line-height: 8px;
    letter-spacing: -2px;
}

/* Enhanced zone dragging visual feedback */
.drop-zone[draggable="true"] {
    cursor: grab;
    transition: all 0.2s ease;
}

/* Only highlight zones during actual drag operations, not on regular hover */
.tag-dragging .drop-zone:hover {
    border-color: var(--color-action-primary);  /* Action Blue for draggable zones */
    background: var(--color-action-light);
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(30, 64, 175, 0.1);
}

.drop-zone.dragging {
    opacity: 0.7;
    cursor: grabbing;
    transform: rotate(2deg);
    z-index: 1000;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

/* Control area drop target styling */
.control-area-container {
    position: relative;
    min-height: 80px;
    transition: all 0.2s ease;

    /* Multi-zone layout */
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    height: 100%;
    align-items: flex-start;
    justify-content: flex-start;
    padding: 8px;
}

.control-area-container.drag-over {
    background: var(--color-action-light);
    border: 2px dashed var(--color-action-primary);
    border-radius: 4px;
}

.control-area-container.drag-over::after {
    content: "Drop zone here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--color-action-primary);
    font-size: 0.9rem;
    font-weight: 500;
    pointer-events: none;
}

/* Drag handles now use light-dark() function for automatic theming */

.drop-zone:hover {
    border-color: var(--color-neutral-400);
    background: var(--color-muji-hover);
}

/* Drag-Drop State Machine Visual Feedback */

/* Tag being dragged over a valid zone */
.drop-zone.tag-drag-over {
    border-color: var(--color-success) !important;  /* Success Green for valid tag drop */
    background: var(--color-success-light) !important;
    color: var(--color-muji-text);
    animation: pulse-success 1.5s ease-in-out infinite;
}

/* Zone being dragged - no visual feedback on other zones */
.drop-zone.zone-drag-invalid {
    /* Intentionally no visual feedback - zone-to-zone drops are blocked */
    opacity: 0.7;
    cursor: not-allowed;
}

/* Control areas when zone is being dragged over them */
.control-area-container.zone-drag-over {
    background: var(--color-action-light) !important;  /* Action Blue background */
    border: 2px dashed var(--color-action-primary) !important;
    border-radius: 4px;
    animation: pulse-action 1.5s ease-in-out infinite;
}

.control-area-container.zone-drag-over::after {
    content: "Drop zone here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--color-action-primary);
    font-size: 0.9rem;
    font-weight: 500;
    pointer-events: none;
}

/* Generic drag-over state (backward compatibility) */
.drop-zone.drag-over {
    border-color: var(--color-success);
    background: var(--color-success-light);
    color: var(--color-muji-text);
}

.drop-zone.invalid-target {
    border-color: #ccc;
    background: #f5f5f5;
    color: #999;
}

/* Drag and Drop States - Updated with Brand/Functional Separation */
.drag-active {
    opacity: 0.7;
}

/* Valid drop target for tags */
.valid-drop-target {
    border-color: var(--color-success) !important;
    background: var(--color-success-light) !important;
    animation: pulse-success 1s infinite;
}

/* Invalid drop target */
.invalid-drop-target {
    border-color: var(--color-error) !important;
    background: var(--color-error-light) !important;
    animation: shake 0.5s ease-in-out;
}

/* Zone being dragged */
.drop-zone.dragging {
    opacity: 0.7;
    cursor: grabbing;
    transform: rotate(2deg);
    z-index: 1000;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    border-color: var(--color-action-primary) !important;
}

/* Animations for different states */
@keyframes pulse-success {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(5, 150, 105, 0.4);
    }
    50% {
        transform: scale(1.02);
        box-shadow: 0 0 0 8px rgba(5, 150, 105, 0);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(5, 150, 105, 0);
    }
}

@keyframes pulse-action {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(30, 64, 175, 0.4);
    }
    50% {
        transform: scale(1.01);
        box-shadow: 0 0 0 8px rgba(30, 64, 175, 0);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(30, 64, 175, 0);
    }
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
    20%, 40%, 60%, 80% { transform: translateX(2px); }
}

/* Multi-select Support */
.tag-item.multi-selected {
    background-color: var(--color-action-primary);  /* Action Blue for multi-select */
    border-color: var(--color-action-accent);
    box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.3);
    transform: scale(1.05);
}

/* Zone Headers */
.zone-header {
    font-size: 0.8rem;
    font-weight: 600;
    color: #495057;
    margin-bottom: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Responsive Design */
@media (max-width: 1200px) {
    .spatial-grid {
        grid-template-columns: 0.5fr 3fr 0.5fr;
    }
}

@media (max-width: 900px) {
    .spatial-grid {
        grid-template-columns: 1fr;
        grid-template-areas:
            "tag-management"
            "universal-control"
            "top-control"
            "ui-control"
            "left-control"
            "card-display"
            "right-control"
            "bottom-control";
    }

    .tag-management {
        order: 1;
    }
}

/* Accessibility - Action Blue for focus states */
.tag-item:focus {
    outline: 2px solid var(--color-action-primary);
    outline-offset: 2px;
}

.drop-zone:focus {
    outline: 2px solid var(--color-action-primary);
    outline-offset: 2px;
}

/* Focus-visible for keyboard navigation */
.tag-item:focus-visible,
.drop-zone:focus-visible,
.cta-button:focus-visible {
    outline: 3px solid var(--color-action-primary);
    outline-offset: 2px;
}

/* Loading States - Brand moment */
.loading {
    opacity: 0.6;
    pointer-events: none;
}

.loading::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid var(--color-neutral-200);
    border-top: 2px solid var(--color-brand-primary);  /* Brand Red for loading */
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Pure HTML Tag System CSS */
.clouds-container {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
}

.clouds-container.vertical {
    display: flex;
    flex-direction: column;
    gap: 16px;
    flex-wrap: nowrap;
}

.clouds-container.horizontal {
    display: flex;
    flex-direction: row;
    gap: 16px;
    flex-wrap: wrap;
    align-items: flex-start;
}

.cloud {
    background-color: light-dark(#fafafa, var(--color-neutral-100));
    border: 1px solid light-dark(#e5e7eb, var(--color-neutral-300));
    border-radius: 8px;
    padding: 16px;
    min-height: 120px;
    min-width: 200px;
    flex: 1;
}

.cloud-user, .cloud-mixed {
    background-color: light-dark(#fefefe, var(--color-neutral-100));
    border-color: light-dark(#e5e7eb, var(--color-neutral-300));
}

.cloud-ai {
    background-color: light-dark(#f9fafb, var(--color-neutral-200));
    border-color: light-dark(#d1d5db, var(--color-neutral-400));
}

.cloud-group {
    background-color: transparent;
    border: 1px dashed light-dark(#9ca3af, var(--color-neutral-400));
}

.cloud-system {
    border-color: light-dark(#4b5563, var(--color-neutral-500));
}

.cloud-title {
    font-size: 12px;
    font-weight: 500;
    margin-bottom: 12px;
    user-select: none;
}

.cloud-title-user, .cloud-title-mixed {
    color: #374151;
}

.cloud-title-ai {
    color: #4b5563;
}

.cloud-title-group {
    color: #6b7280;
}

.cloud-title-system {
    color: #111827;
}

.tag-count {
    margin-left: 8px;
    font-weight: normal;
    color: #9ca3af;
}

.tags-wrapper {
    display: flex;
    flex-wrap: wrap;
}

.tag {
    display: inline-block;
    margin: 3px;
    padding: 4px 8px;
    font-size: 11px;
    user-select: none;
    border-radius: 2px;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.tag:hover {
    opacity: 0.8;
}

.tag-user {
    background-color: light-dark(#ffffff, var(--color-neutral-200));
    border: 1px solid light-dark(#d1d5db, var(--color-neutral-400));
    color: light-dark(#374151, var(--color-text-primary));
}

.tag-ai {
    background-color: light-dark(#f3f4f6, var(--color-neutral-300));
    border: 1px solid light-dark(#d1d5db, var(--color-neutral-400));
    color: light-dark(#4a5568, var(--color-text-secondary));
    font-style: italic;
}

.tag-group {
    background-color: transparent;
    border: 1px dashed light-dark(#9ca3af, var(--color-neutral-400));
    color: light-dark(#6b7280, var(--color-text-secondary));
    border-radius: 4px;
}

.tag-system {
    background-color: light-dark(#e5e7eb, var(--color-neutral-300));
    border: 1px solid light-dark(#9ca3af, var(--color-neutral-500));
    color: light-dark(#1f2937, var(--color-text-primary));
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-radius: 1px;
}

.input-wrapper {
    display: flex;
    gap: 8px;
    margin-top: 12px;
}

.tag-input {
    flex: 1;
    font-size: 10px;
    padding: 8px;
    border: 1px solid light-dark(#d1d5db, var(--color-neutral-400));
    background-color: light-dark(rgba(255, 255, 255, 0.8), var(--color-neutral-200));
    border-radius: 2px;
    outline: none;
    color: var(--color-text-primary);
}

.tag-input:focus {
    border-color: #9ca3af;
}

.ai-button {
    font-size: 9px;
    padding: 4px 8px;
    background-color: light-dark(#e5e7eb, var(--color-neutral-300));
    border: 1px solid light-dark(#d1d5db, var(--color-neutral-400));
    border-radius: 2px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    color: var(--color-text-primary);
}

.ai-button:hover {
    background-color: light-dark(#d1d5db, var(--color-neutral-400));
}

/* CSS-only Font Dropdown */
.font-dropdown-wrapper {
    position: relative;
    display: inline-block;
    min-width: 140px;
    max-width: 160px;
}

.font-dropdown-current {
    font-size: 12px;
    padding: 3px 6px;
    border: 1px solid light-dark(#d1d5db, var(--color-neutral-400));
    border-radius: 2px;
    background-color: light-dark(white, var(--color-neutral-200));
    cursor: pointer;
    user-select: none;
    position: relative;
    color: var(--color-text-primary);
}

.font-dropdown-current:hover {
    border-color: #9ca3af;
}

.font-dropdown-current:focus {
    border-color: #9ca3af;
    outline: none;
}

/* Add dropdown arrow */
.font-dropdown-current::after {
    content: "▼";
    position: absolute;
    right: 6px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 8px;
    color: #6b7280;
    pointer-events: none;
}

.font-dropdown-options {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: light-dark(white, var(--color-neutral-100));
    border: 1px solid light-dark(#d1d5db, var(--color-neutral-400));
    border-top: none;
    border-radius: 0 0 2px 2px;
    max-height: 200px;
    overflow-y: auto;
    z-index: 1000;
    display: none;
    box-shadow: 0 2px 4px light-dark(rgba(0,0,0,0.1), rgba(0,0,0,0.3));
}

/* Show dropdown on hover and focus */
.font-dropdown-wrapper:hover .font-dropdown-options,
.font-dropdown-wrapper:focus-within .font-dropdown-options {
    display: block;
}

.font-dropdown-option {
    display: block;
    padding: 6px 8px;
    font-size: 12px;
    cursor: pointer;
    transition: background-color 0.1s;
    border: none;
    background: none;
    width: 100%;
    text-align: left;
    color: var(--color-text-primary);
}

.font-dropdown-option:hover {
    background-color: light-dark(#f3f4f6, var(--color-neutral-300));
}

/* Font dropdown options inherit from body font classes */

.controls label {
    font-size: 12px;
    color: #4b5563;
    margin: 0;
    margin-bottom: 4px;
}

.font-group {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: #4b5563;
}

.checkbox-group {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: #4b5563;
}

.checkbox-group input[type="checkbox"] {
    margin: 0;
}

/* Theme Radio Buttons - Simple Style */
.theme-switch-group {
    margin-bottom: 16px;
}

.theme-radio-group {
    display: flex;
    gap: 16px;
    margin-top: 8px;
    align-items: center;
}

.theme-radio-item {
    display: flex;
    align-items: center;
    gap: 6px;
}

.theme-radio-item input[type="radio"] {
    width: 14px;
    height: 14px;
    margin: 0;
    cursor: pointer;
    accent-color: light-dark(#333, #d4d4d4);
}

.theme-radio-item label {
    font-size: 11px;
    color: light-dark(#666, #999);
    text-transform: lowercase;
    letter-spacing: 0.02em;
    cursor: pointer;
    user-select: none;
}

.theme-radio-item input[type="radio"]:checked + label {
    color: light-dark(#333, #d4d4d4);
    font-weight: 500;
}

.theme-label {
    display: block;
    margin-bottom: 8px;
    font-size: 10px;
    color: light-dark(#9ca3af, #6b7280);
    text-transform: lowercase;
    letter-spacing: 0.05em;
}

.controls {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 1rem 0;
}

.controls > * {
    margin: 0;
}

.debug-group {
    margin: 0;
}

.database-group {
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.database-selector {
    padding: 4px 8px;
    border: 1px solid light-dark(var(--color-neutral-300), var(--color-neutral-400));
    border-radius: 4px;
    background: light-dark(white, var(--color-neutral-200));
    font-size: 12px;
    font-family: inherit; /* Use selected font */
    color: var(--color-text-primary);
    min-width: 200px;
}

.database-selector:focus {
    outline: none;
    border-color: var(--color-action-primary);
    box-shadow: 0 0 0 2px var(--color-action-light);
}

.database-info {
    font-size: 11px;
    color: var(--color-text-secondary);
    font-style: italic;
}

/* Earth tones consolidated section moved above - this section removed */

/* ========================================
   MUJI-INSPIRED CARD SYSTEM
   ======================================== */

/* True Muji Card Container - Simple List */
.card-container {
    display: block; /* Simple block layout - no flex tricks */
    padding: 0; /* No padding - let content breathe naturally */
    max-width: 100%;
}

/* TRUE MUJI AESTHETIC - Pure Minimalism */
.card {
    background: light-dark(#f8f8f8, var(--color-neutral-200)); /* Clean contrast in dark mode */
    border: none; /* NO BORDERS - Pure Muji */
    border-radius: 0; /* NO ROUNDED CORNERS - True minimalism */
    padding: 16px 16px 16px 20px; /* Add left padding for visual indicator */
    margin: 8px 0; /* Minimal vertical spacing */
    width: 300px; /* Fixed width for uniformity */;
    transition: background 0.2s ease; /* Subtle transition for hover */
    box-shadow: none;
    font-family: inherit; /* Inherit selected font from body */
    line-height: 1.5; /* Standard line height */
    display: block; /* Simple block layout */
    position: relative; /* For visual indicator positioning */
}

.card:hover {
    background: light-dark(#f5f5f5, var(--color-neutral-300)); /* Subtle hover indication */
}

/* Pure CSS accordion checkbox styling */
.card-accordion-toggle {
    position: absolute;
    left: 50%;
    bottom: 0;
    transform: translateX(-50%) translateY(50%);
    width: 8.4px; /* 30% smaller: 12px * 0.7 = 8.4px */
    height: 8.4px;
    margin: 0;
    appearance: none;
    -webkit-appearance: none;
    background: #007AFF; /* Blue dot when closed */
    border: none;
    border-radius: 50%;
    cursor: pointer;
    z-index: 10;
    transition: all 0.2s ease;
}

.card-accordion-toggle:checked {
    background: #007AFF; /* Blue circle when open */
    border: 2px solid #007AFF;
    background-clip: padding-box;
    box-shadow: inset 0 0 0 2px white; /* White center */
}

.card-accordion-toggle:hover {
    transform: translateX(-50%) translateY(50%) scale(1.1);
}

.card:last-child {
    margin-bottom: 0; /* Remove margin on last item */
}

/* Muji Typography - Left and Top Aligned */
.card-title {
    color: var(--color-text-primary); /* Adaptive text color */
    font-size: 14px; /* Small, humble font size like Muji labels */
    font-weight: 400; /* Normal weight - no bold */
    margin: 0 0 8px 0; /* Minimal spacing */
    letter-spacing: 0; /* No letter spacing tricks */
    text-align: left; /* Left aligned */
    font-family: inherit; /* Inherit selected font */
}

.card-description {
    color: var(--color-text-secondary); /* Adaptive secondary text */
    font-size: 12px; /* Even smaller for descriptions */
    font-weight: 400;
    margin: 0 0 12px 0; /* Add margin for accordion separator */
    line-height: 1.4;
    text-align: left; /* Left aligned */
    font-family: inherit; /* Inherit selected font */
}

/* TAGS SYSTEM - Pure CSS Accordion */
.card-tags {
    border-top: 1px solid light-dark(#e0e0e0, var(--color-neutral-300)); /* Adaptive separator */
    padding-top: 8px;
    margin-top: 8px;
    display: none; /* Hidden by default */
    position: relative; /* For checkbox positioning */
}

/* Show tags when individual card accordion is checked */
.card-accordion-toggle:checked + .card-tags {
    display: block;
}

.card-tag {
    display: inline-block;
    background: light-dark(#e8e8e8, var(--color-neutral-300));
    color: light-dark(#666, var(--color-text-secondary));
    font-size: 10px;
    font-weight: 400;
    padding: 3px 8px;
    margin: 2px 4px 2px 0;
    border-radius: 0; /* No rounded corners - Muji style */
    border: none;
    font-family: inherit; /* Inherit selected font */
    letter-spacing: 0;
}

/* Show tags when colors/show colors is enabled - controlled by WASM */
.show-colors .card-tags {
    display: block;
}

/* When cards-expanded is enabled, show tags by default */
.cards-expanded .card-tags {
    display: block;
}

/* Style the toggle to appear open when cards-expanded is enabled */
.cards-expanded .card-accordion-toggle {
    background: #007AFF;
    border: 2px solid #007AFF;
    background-clip: padding-box;
    box-shadow: inset 0 0 0 2px white; /* White center for open state */
}

/* Earth tones card styles moved to consolidated section above */

/* Dark Mode Variant now handled automatically via light-dark() */

/* Dark Mode + Earth Tones now handled automatically via light-dark() */

/* True Muji - No Responsive Tricks - Content Flows Naturally */

/* Earth tones styles moved to consolidated section above */

/* Advanced View Mode Styles - Minimal visual changes */
.advanced-view .clouds-container {
    /* No special styling - use default appearance */
}

.advanced-view .cloud {
    /* No special styling - use default appearance */
}

.advanced-view .view-description {
    /* No special styling - use default appearance */
}

.advanced-view .view-legend {
    /* No special styling - use default appearance */
}

/* Font Classes for Dynamic Font Switching - Research-Based Google Fonts with System Fallbacks */

.font-helvetica,
body.font-helvetica {
    font-family: 'Libre Franklin', 'Helvetica Neue', Helvetica, 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif !important;
}

.font-libre-franklin,
body.font-libre-franklin {
    font-family: 'Libre Franklin', 'Helvetica Neue', Helvetica, -apple-system, BlinkMacSystemFont, sans-serif !important;
}

.font-source-sans,
body.font-source-sans {
    font-family: 'Source Sans 3', 'Source Sans Pro', 'Helvetica Neue', Helvetica, system-ui, sans-serif !important;
}

.font-avenir,
body.font-avenir {
    font-family: 'Mulish', 'Avenir', 'Avenir Next', -apple-system, BlinkMacSystemFont, system-ui, 'Segoe UI', sans-serif !important;
}

.font-akzidenz,
body.font-akzidenz {
    font-family: 'Work Sans', 'Akzidenz-Grotesk', 'IBM Plex Sans', Arial, 'Helvetica Neue', sans-serif !important;
}

.font-sanfrancisco,
body.font-sanfrancisco {
    font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'San Francisco', 'SF Pro Display', system-ui, 'Segoe UI', sans-serif !important;
}

.font-roboto,
body.font-roboto {
    font-family: 'Roboto', 'Open Sans', system-ui, 'Segoe UI', 'Liberation Sans', sans-serif !important;
}

.font-optima,
body.font-optima {
    font-family: 'Lato', 'Optima', 'Montserrat', 'Segoe UI', system-ui, 'Liberation Sans', sans-serif !important;
}

.font-merriweather,
body.font-merriweather {
    font-family: 'Merriweather Sans', 'Open Sans', 'IBM Plex Sans', Georgia, 'Times New Roman', serif !important;
    font-weight: 300 !important;
}

.font-inconsolata,
body.font-inconsolata {
    font-family: 'Inconsolata', 'Consolas', 'Monaco', 'Menlo', 'Courier New', monospace !important;
    font-weight: 200 !important;
}

.font-berkeley-mono,
body.font-berkeley-mono {
    font-family: 'Berkeley Mono', 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'Consolas', monospace !important;
    font-weight: 400 !important;
}

/* Debug Input Styling */
.debug-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: #4b5563;
}

.tags-in-play {
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    font-size: 10px;
    padding: 4px 8px;
    border: 1px solid light-dark(#d1d5db, var(--color-neutral-400));
    background-color: light-dark(#f9f9f9, var(--color-neutral-200));
    border-radius: 2px;
    outline: none;
    font-family: 'Courier New', 'Monaco', monospace;
    color: var(--color-text-secondary);
    resize: vertical;
}

.tags-in-play:focus {
    border-color: light-dark(#9ca3af, var(--color-neutral-500));
    background-color: light-dark(#ffffff, var(--color-neutral-300));
}

/* Dark Mode Styles removed - now using light-dark() function */

/* Dark mode now handled automatically via light-dark() function in :root */
/* All dark mode overrides removed - theme switching is automatic */

/* Zone drag handles for zone movement */
.zone-drag-handle {
    position: absolute;
    left: 8px;
    top: 50%;
    transform: translateY(-50%);
    cursor: grab;
    padding: 4px;
    border-radius: 2px;
    transition: all 0.2s ease;
    z-index: 10;
}

.zone-drag-handle-right {
    left: auto;
    right: 8px;
}

.zone-drag-handle:hover {
    background: rgba(0, 0, 0, 0.1);
}

.zone-drag-handle:active {
    cursor: grabbing;
    background: rgba(0, 0, 0, 0.15);
}

.drag-grip {
    color: #aaa;
    font-size: 14px;
    line-height: 1;
    user-select: none;
    display: block;
    transition: color 0.2s ease;
}

.zone-drag-handle:hover .drag-grip {
    color: #666;
}

/* Earth tones comprehensive interface styles moved to consolidated section above */

/* ========================================
   ADDITIONAL DRAG-DROP STATE HELPERS
   ======================================== */

/* Empty State Brand Moments */
.empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 3rem;
    color: var(--color-neutral-500);
}

.empty-state-icon {
    width: 64px;
    height: 64px;
    margin-bottom: 1rem;
    color: var(--color-brand-primary);  /* Brand Red for empty state icons */
    opacity: 0.5;
}

.empty-state-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--color-neutral-700);
    margin-bottom: 0.5rem;
}

.empty-state-description {
    font-size: 0.875rem;
    color: var(--color-neutral-500);
    text-align: center;
    max-width: 320px;
}

/* Celebration States - Brand Moments */
.celebration {
    animation: celebrate 0.5s ease-out;
}

@keyframes celebrate {
    0% {
        transform: scale(1) rotate(0deg);
    }
    50% {
        transform: scale(1.1) rotate(5deg);
        border-color: var(--color-brand-primary);
        box-shadow: 0 0 20px rgba(220, 38, 38, 0.3);
    }
    100% {
        transform: scale(1) rotate(0deg);
    }
}

/* Progress Indicators - Action Blue */
.progress-bar {
    background: var(--color-neutral-200);
    height: 4px;
    border-radius: 2px;
    overflow: hidden;
}

.progress-bar-fill {
    height: 100%;
    background: var(--color-action-primary);  /* Action Blue for progress */
    transition: width 0.3s ease;
}

/* Tooltip States */
.tooltip {
    position: absolute;
    background: var(--color-neutral-900);
    color: white;
    padding: 0.5rem 0.75rem;
    border-radius: 4px;
    font-size: 0.75rem;
    white-space: nowrap;
    z-index: 9999;
    pointer-events: none;
}

.tooltip::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 4px solid transparent;
    border-right: 4px solid transparent;
    border-top: 4px solid var(--color-neutral-900);
}

/* Badge States */
.badge {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    font-weight: 500;
    border-radius: 9999px;
}

.badge-brand {
    background: var(--color-brand-accent);
    color: var(--color-brand-primary);
    border: 1px solid var(--color-brand-primary);
}

.badge-action {
    background: var(--color-action-light);
    color: var(--color-action-primary);
    border: 1px solid var(--color-action-primary);
}

.badge-success {
    background: var(--color-success-light);
    color: var(--color-success);
    border: 1px solid var(--color-success);
}

.badge-warning {
    background: var(--color-warning-light);
    color: var(--color-warning);
    border: 1px solid var(--color-warning);
}

.badge-error {
    background: var(--color-error-light);
    color: var(--color-error);
    border: 1px solid var(--color-error);
}

/* Improved Drag Ghost */
.drag-ghost {
    position: fixed;
    pointer-events: none;
    z-index: 10000;
    opacity: 0.8;
    transform: rotate(3deg) scale(1.05);
}

/* Visual Feedback for Different Drag Types */
.tag-dragging {
    cursor: grabbing !important;
}

.tag-dragging .drop-zone:not(.tag-drag-over) {
    opacity: 0.6;
}

.zone-dragging {
    cursor: grabbing !important;
}

.zone-dragging .drop-zone {
    opacity: 0.6;
}

.zone-dragging .control-area-container {
    transition: all 0.2s ease;
}

/* Hover Effects Enhancement */
.tag-item {
    position: relative;
}

.tag-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, transparent, rgba(255, 255, 255, 0.1));
    border-radius: 4px;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.tag-item:hover::before {
    opacity: 1;
}

/* Selected Tag Enhancement */
.tag-item.selected::after {
    content: '✓';
    position: absolute;
    top: -4px;
    right: -4px;
    background: var(--color-action-primary);
    color: white;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: bold;
    border: 2px solid var(--color-muji-bg);
}

/* ========================================
   FILTER ZONE - DUAL DROP ZONES
   ======================================== */

.filter-zone-container {
    display: flex;
    flex-direction: row;
    gap: 16px;
    width: 100%;
    height: 100%;
    padding: 16px 32px;
    border: 2px solid light-dark(var(--color-neutral-200), var(--color-neutral-300));
    border-radius: 8px;
    background: light-dark(var(--color-neutral-150), var(--color-neutral-100));
    position: relative;
    align-items: stretch;
    box-sizing: border-box;
}

.filter-subzone {
    flex: 1;
    padding: 12px 16px;
    border: 2px dashed light-dark(var(--color-neutral-300), var(--color-neutral-400));
    border-radius: 6px;
    background: light-dark(var(--color-neutral-50), var(--color-neutral-200));
    min-height: 60px;
    height: 100%;
    transition: all 0.2s ease, border-color 0.8s ease, background-color 0.8s ease;
    display: flex;
    flex-direction: column;
    cursor: pointer;
    box-sizing: border-box;
}

/* .union-zone {
    border-color: #2196F3 !important;
    background: rgba(33, 150, 243, 0.05);
} */

.union-zone:hover,
.union-zone.drag-over {
    border-color: #1976D2 !important;
    background: rgba(33, 150, 243, 0.1);
    border-style: solid !important;
}

/* .intersection-zone {
    border-color: #4CAF50 !important;
    background: rgba(76, 175, 80, 0.05);
} */

.intersection-zone:hover,
.intersection-zone.drag-over {
    border-color: #45a049 !important;
    background: rgba(76, 175, 80, 0.1);
    border-style: solid !important;
}

.filter-subzone:hover {
    border-color: light-dark(var(--color-neutral-400), var(--color-neutral-500));
    background: light-dark(var(--color-neutral-50), var(--color-neutral-300));
}

.filter-subzone.drag-over {
    border-color: var(--color-success);
    background: var(--color-success-light);
    transform: scale(1.02);
}

.filter-subzone.fade-out {
    border-color: light-dark(var(--color-neutral-200), var(--color-neutral-300));
    background: light-dark(white, var(--color-neutral-200));
    transform: scale(1.0);
    transition: all 0.6s ease;
}

.filter-subzone .zone-label {
    font-size: 0.8rem;
    font-weight: 300;
    color: var(--color-text-secondary);
    margin-bottom: 8px;
    display: block;
    text-align: center;
    order: -1;
}

.filter-subzone .tag-collection {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    min-height: 32px;
    justify-content: center;
    align-items: center;
}

/* Disable highlighting on filter zone container - only subzones should highlight */
.filter-zone-container.tag-drag-over,
.filter-zone-container.drag-over {
    border-color: var(--color-neutral-200) !important;
    background: var(--color-neutral-50) !important;
    animation: none !important;
}

/* Union and intersection zones act as individual drop zones */
.filter-subzone.drop-zone:hover {
    border-color: var(--color-action-primary);
    background: var(--color-action-light);
    transform: scale(1.02);
}

/* Cloud drag-over styles for receiving tags back from zones */
.cloud.drag-over {
    border-color: var(--color-action-primary);
    background: var(--color-action-light);
    transform: scale(1.02);
    transition: all 0.3s ease;
    box-shadow: 0 4px 8px rgba(30, 64, 175, 0.15);
}

.clouds-container.drag-over {
    background: rgba(30, 64, 175, 0.05);
    border-radius: 8px;
}

/* Cloud drag-over handled automatically via light-dark() */

/* Earth tones cloud drag-over moved to consolidated section above */

/* Zone Separator with Red Dot */
.zone-separator {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 8px;
    height: auto;
    margin: 0 4px;
    align-self: stretch;
}

.separator-dot {
    width: 8px;
    height: 8px;
    background: var(--color-brand-primary);
    border-radius: 50%;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* Tags within filter zones */
.filter-subzone .tag {
    background: light-dark(var(--color-neutral-100), var(--color-neutral-300));
    border: 1px solid light-dark(var(--color-neutral-300), var(--color-neutral-400));
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 500;
    color: light-dark(var(--color-neutral-700), var(--color-text-primary));
    cursor: pointer;
    transition: all 0.2s ease;
}

.filter-subzone .tag:hover {
    background: light-dark(var(--color-neutral-200), var(--color-neutral-400));
    border-color: light-dark(var(--color-neutral-400), var(--color-neutral-500));
}

.union-zone .tag {
}

.intersection-zone .tag {
}

/* ========================================
   PROJECTS MENU STYLES
   ======================================== */

.projects-menu-container {
    position: relative;
}

.projects-menu {
    position: relative;
    display: inline-block;
}

.projects-link {
    text-decoration: none;
    color: var(--color-text-secondary);
    font-weight: 400;
    font-size: 0.9rem;
    padding: 0.5rem 0;
    transition: color 0.3s ease;
    font-family: inherit;
}

.projects-link:hover {
    color: var(--color-brand-primary);
}

.project-menu-item {
    display: block;
    padding: 8px 0;
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.85rem;
    transition: color 0.3s ease;
    cursor: pointer;
}

.project-menu-item:hover {
    color: var(--color-brand-primary);
}

.project-menu-item.current-project {
    color: var(--color-action-primary);
    font-weight: 500;
}

.projects-dropdown-content {
    position: relative;
    display: inline-block;
}

.projects-submenu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background: var(--color-muji-bg);
    border: 1px solid var(--color-muji-border);
    border-radius: 4px;
    padding: 0.5rem 0;
    min-width: 200px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    z-index: 1000;
}

.projects-dropdown-content:hover .projects-submenu {
    display: block;
}

.projects-submenu .project-menu-item {
    display: block;
    padding: 0.5rem 1rem;
    white-space: nowrap;
}

/* ========================================
   DRAG-DROP VISUAL STATES
   ======================================== */

/* Multi-select visual states */
.tag.selected {
    outline: 2px solid var(--color-action-primary);
    outline-offset: 2px;
    background-color: var(--color-action-light);
}

.tag.dragging {
    opacity: 0.5;
    cursor: grabbing;
    transform: rotate(2deg);
    transition: opacity 0.2s ease, transform 0.2s ease;
}

/* Zone drag-over states */
.drop-zone.drag-over,
[data-zone-type].drag-over {
    background-color: var(--color-success-light);
    border-color: var(--color-success);
    box-shadow: 0 0 0 2px var(--color-success-light);
    transform: scale(1.02);
    transition: all 0.2s ease;
}

/* Multi-tag drop count badge */
[data-drop-count]::after {
    content: attr(data-drop-count);
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--color-action-primary);
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: bold;
    border: 2px solid white;
    z-index: 10;
}

/* Cloud drag-over states */
.cloud.drag-over {
    background-color: var(--color-action-light);
    border-color: var(--color-action-primary);
    transform: scale(1.01);
    transition: all 0.2s ease;
}

/* Accessibility improvements */
[aria-grabbed="true"] {
    cursor: grabbing;
    opacity: 0.8;
}

[aria-selected="true"] {
    background-color: var(--color-action-light);
    border-color: var(--color-action-primary);
}

/* Zone role styling */
[role="region"][data-zone-type] {
    position: relative;
}

[role="region"][data-zone-type]:focus-within {
    outline: 2px dotted var(--color-action-primary);
    outline-offset: 4px;
}

/* Tag cursor states */
.tag[draggable="true"] {
    cursor: grab;
}

.tag[draggable="true"]:active {
    cursor: grabbing;
}

/* Visual feedback for valid drop targets */
.tag-collection {
    min-height: 2rem;
    border-radius: 4px;
    transition: background-color 0.2s ease;
}

.tag-collection:empty::before {
    content: "Drop tags here";
    color: var(--color-text-secondary);
    font-style: italic;
    font-size: 0.85rem;
}

/* Animation for tag movement */
.tag {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.tag:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Group tag indicators */
.tag-group {
    position: relative;
    background: linear-gradient(135deg, var(--color-success-light), var(--color-success));
}

.tag-group::before {
    content: '⊕';
    margin-right: 4px;
    font-weight: bold;
}

/* Zone visual enhancements */
.zone-label {
    user-select: none;
    font-weight: 500;
    color: var(--color-text-secondary);
}

/* Smooth transitions for all interactive elements */
.drop-zone,
.tag,
.cloud {
    transition: all 0.2s ease;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    .tag.selected {
        outline-width: 3px;
        background-color: ButtonHighlight;
        color: ButtonText;
    }

    [data-zone-type].drag-over {
        outline: 3px solid Highlight;
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .tag,
    .drop-zone,
    .cloud,
    .tag-collection {
        transition: none;
    }

    .tag.dragging {
        transform: none;
    }

    [data-zone-type].drag-over {
        transform: none;
    }
}
